# Testwork **Fanbox**
## Level 3 Q2 Задание:
> <https://dl.fun-box.ru/qt-ruby.pdf> 

## Выполнение
1. Для обновления данных нужен вебсокет, использовал Cable.
2. Для получения новых новостей использую воркер написаный на Sidekiq.
3. Чтобы парсер не попадал в спам, использую Phantomjs, а результаты его работы
   разбираю Nokogiri.
4. Вынес сложные операции из моделей <https://mkdev.me/posts/paru-slov-pro-interaktory-v-rails>.
5. Храню курс cкопированный с сервера отдельно. Так-как нас интересует только последний
   курс, то храню его в redis как строка. 
6. Использую React на клиенской стороне, для ускорения перерисовки новостей.
7. Использованы локали.
8. Так как использую много всего специфичного, то использую Docker.

## Запуск
1. `docker-compose build`
2. `docker-compose up -d` ждем 5-10 минут
3. `docker exec testwork_web_1  bash -l -c "bundle exec rake db:migrate"`
4. `docker exec testwork_web_1  bash -l -c "RAILS_ENV=test && bundle exec rspec spec"`

## Эксплуатация
* При заполнении в админке, надо указывать время завершения, по умолчанию
время завершение текущее, тоесть показывать не будет.
* Если есть 2 пользовательских курса, 1 выводится тот, что имеет большее время
  до истечения показа.
